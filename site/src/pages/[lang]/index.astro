---
export const prerender = true;

import Layout from '../../layouts/Layout.astro';
import WordCard from '../../components/WordCard.astro';
import { getAllWords, getCategoryIcon } from '../../lib/data';
import { getAvailableLanguages } from '../../lib/data';

export function getStaticPaths() {
  return getAvailableLanguages().map((lang) => ({
    params: { lang },
  }));
}

const { lang } = Astro.params;
const words = getAllWords(lang);

// Group words by category
const wordsByCategory = words.reduce(
  (acc, word) => {
    if (!acc[word.category]) {
      acc[word.category] = [];
    }
    acc[word.category].push(word);
    return acc;
  },
  {} as Record<string, typeof words>
);

const titles: Record<string, string> = {
  en: 'Chinese Dictionary - Learn Modern Chinese',
  ko: 'ì¤‘êµ­ì–´ ì‚¬ì „ - í˜„ëŒ€ ì¤‘êµ­ì–´ ë°°ìš°ê¸°',
  ja: 'ä¸­å›½èªè¾å…¸ - ç¾ä»£ä¸­å›½èªã‚’å­¦ã¶',
};

const subtitles: Record<string, string> = {
  en: 'Discover Chinese slang, internet terms, and modern expressions',
  ko: 'ì¤‘êµ­ì–´ ì†ì–´, ì¸í„°ë„· ìš©ì–´, í˜„ëŒ€ í‘œí˜„ì„ ì•Œì•„ë³´ì„¸ìš”',
  ja: 'ä¸­å›½èªã®ã‚¹ãƒ©ãƒ³ã‚°ã€ãƒãƒƒãƒˆç”¨èªã€ç¾ä»£çš„ãªè¡¨ç¾ã‚’å­¦ã¼ã†',
};
---

<Layout title={titles[lang] || titles.en} lang={lang} canonical={`/${lang}/`}>
  <!-- Hero Section -->
  <div class="text-center mb-12">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">
      ğŸ€„ {titles[lang] || titles.en}
    </h1>
    <p class="text-lg text-gray-600 max-w-2xl mx-auto">
      {subtitles[lang] || subtitles.en}
    </p>
  </div>

  <!-- Featured Words -->
  <section class="mb-12">
    <h2 class="text-2xl font-bold text-gray-900 mb-6">
      {lang === 'ja' ? 'æœ€æ–°ã®å˜èª' : lang === 'ko' ? 'ìµœì‹  ë‹¨ì–´' : 'Latest Words'}
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {words.slice(0, 6).map((word) => <WordCard word={word} lang={lang} />)}
    </div>
  </section>

  <!-- Words by Category -->
  {
    Object.entries(wordsByCategory).map(([category, categoryWords]) => (
      <section class="mb-12">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
            <span>{getCategoryIcon(category)}</span>
            {category}
          </h2>
          <a
            href={`/${lang}/category/${category}`}
            class="text-red-600 hover:text-red-700 text-sm font-medium"
          >
            {lang === 'ja' ? 'ã™ã¹ã¦è¦‹ã‚‹ â†’' : lang === 'ko' ? 'ëª¨ë‘ ë³´ê¸° â†’' : 'View all â†’'}
          </a>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          {categoryWords.slice(0, 4).map((word) => (
            <WordCard word={word} lang={lang} />
          ))}
        </div>
      </section>
    ))
  }

  <!-- Ad Space (In-content) -->
  <div class="my-8 p-8 bg-gray-100 rounded-lg text-center text-gray-400">Ad Space</div>
</Layout>
